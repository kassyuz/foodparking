<html>
	<head>
		<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />		
		<meta name="title" content="Food Parking - Coming Soon">
		<meta name="url" content="http://www.foodparking.com">
		<meta name="description" content="www.foodparking.com">
		<meta name="keywords" content="food, truck,burger,bier,hamburguer">
		<meta name="autor" content="Bruno Kluever Koneski">
		<meta name="revisit-after" content="10">
		<link href="resources/images/favicon/parking.ico" type="image/x-icon" rel="shortcut icon">
		<link href="resources/images/favicon/parking.ico" type="image/x-icon" rel="icon">
		<link rev=made href="mailto:bruno@koneski.org.br">
		<meta charset='utf-8' />
		<meta content='IE=edge,chrome=1' http-equiv='X-UA-Compatible' />

		<title>
		Coming Soon
		</title>

		<style>
			html, body { height: 100%; margin: 0; padding: 0; border: 0px; }		
			#map { 
				height: 100%; 
			}
			.img-temp{
				width: 30%;
				display: block;
				margin: auto;
				padding-top: 5%;
				display:none;
			}
		</style>	
	</head>
	
	<body>	
		<div id="map"></div>
		<img class="img-temp" src="resources/images/temp/ilove.jpg">
	</body>

	
	<script src="resources/js/jquery-1.11.1.min.js"></script>
	<script src="resources/js/FP.js"></script>
	<script>		

		var joinville;
		var browserSupportFlag =  new Boolean();

		var styles = [{"featureType":"landscape.natural","elementType":"geometry.fill","stylers":[{"visibility":"on"},{"color":"#e0efef"}]},{"featureType":"poi","elementType":"geometry.fill","stylers":[{"visibility":"on"},{"hue":"#1900ff"},{"color":"#c0e8e8"}]},{"featureType":"road","elementType":"geometry","stylers":[{"lightness":100},{"visibility":"simplified"}]},{"featureType":"road","elementType":"labels","stylers":[{"visibility":"off"}]},{"featureType":"transit.line","elementType":"geometry","stylers":[{"visibility":"on"},{"lightness":700}]},{"featureType":"water","elementType":"all","stylers":[{"color":"#7dcdcd"}]}];




		var map;
		function initMap() {
			joinville = new google.maps.LatLng(-26.299196, -48.850555);
		  map = new google.maps.Map(document.getElementById('map'), {
			zoom: 14
		  });
		  map.setOptions({styles: styles});

		  // Try W3C Geolocation (Preferred)
		  if(navigator.geolocation) {
			browserSupportFlag = true;
			navigator.geolocation.getCurrentPosition(function(position) {
			  initialLocation = new google.maps.LatLng(position.coords.latitude,position.coords.longitude);
			  map.setCenter(initialLocation);
			}, function() {
			  handleNoGeolocation(browserSupportFlag);
			});
		  }
		  // Browser doesn't support Geolocation
		  else {
			browserSupportFlag = false;
			handleNoGeolocation(browserSupportFlag);
		  }
			map.setZoom(15);
		}

		function handleNoGeolocation(errorFlag) {
			initialLocation = joinville;
			if (errorFlag == true) {
			  console.warn("Geolocation service failed.");			  
			} else {
			  console.warn("Your browser doesn't support geolocation. We've placed you in Siberia.");
			}
			map.setCenter(initialLocation);
		  }

		function getAlTrucks(){
			FP.get({
				url: "rest/truck/all", 
				success: function( trucks ) {
					$.each(trucks, function( index, truck ) {
						var pos = new google.maps.LatLng(truck.latitude, truck.longitude);
						var marker = new google.maps.Marker({
							position: pos,
							map: map,
							title: truck.title,
							label:truck.title,
							icon: 'resources/images/markers/truck_blue.png',
							animation: google.maps.Animation.DROP
						  });						

						var infowindow = new google.maps.InfoWindow({
							content: "<b>"+truck.title+"</b>"
						  });

						  marker.addListener('click', function() {
							infowindow.open(map, marker);
							map.setZoom(map.getZoom()+1);
							map.setCenter(marker.getPosition());							
						});

						marker.addListener('dblclick', function() {
							infowindow.open(map, marker);
							map.setZoom(19);							
							map.setCenter(marker.getPosition());		

						});
					});					
				}
			});	
		}

		$(function() {
			 getAlTrucks();
		});

	</script>
	<script async defer
      src="https://maps.googleapis.com/maps/api/js?callback=initMap">
    </script>
</html>
